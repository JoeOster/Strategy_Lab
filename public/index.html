<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Strategy Lab</title>
    <link rel="stylesheet" href="css/main.css?v=1.0.2" />
    <link rel="stylesheet" href="css/themes.css?v=1.0.1" />
  </head>
  <body>
    <div class="app-container">
      <header class="header">
        <img
          src="images/strategy-lab-logo.svg"
          alt="Strategy Lab Logo"
          class="header-logo"
        />
        <div id="user-select-container" class="user-select-container">
          <label for="user-select-dropdown" class="visually-hidden"
            >Select User:</label
          >
          <select id="user-select-dropdown" class="user-select-dropdown">
            <option value="">Select User</option>
          </select>
        </div>
      </header>
      <nav class="main-nav">
        <button type="button" class="nav-btn" data-tab="dashboard">
          Dashboard
        </button>
        <button type="button" class="nav-btn" data-tab="orders">Orders</button>
        <button type="button" class="nav-btn" data-tab="ledger">Ledger</button>
        <button type="button" class="nav-btn" data-tab="strategy-lab">
          Strategy Lab
        </button>
        <button type="button" class="nav-btn" data-tab="imports">
          Imports
        </button>
        <button type="button" class="nav-btn" data-tab="daily-report">
          Daily Report
        </button>
        <button type="button" class="nav-btn" data-tab="settings">
          Settings
        </button>
      </nav>
      <main id="app-content" class="main-content"></main>
    </div>

    <div id="settings-modal" class="modal">
      <div class="modal-content">
        <span class="close-button">&times;</span>
        <h2>Settings</h2>

        <div class="settings-tabs">
          <button class="settings-tab active" data-tab="general-settings-panel">
            General
          </button>
          <button class="settings-tab" data-tab="appearance-settings-panel">
            Appearance
          </button>
          <button
            class="settings-tab"
            data-tab="data-management-settings-panel"
          >
            Data Management
          </button>
          <button
            class="settings-tab"
            data-tab="user-management-settings-panel"
          >
            User Management
          </button>
        </div>

        <div id="general-settings-panel" class="settings-panel active">
          <h3>General</h3>
          <form id="general-settings-form">
            <label for="family-name">App Title:</label>
            <input type="text" id="family-name" name="family-name" />
            <label for="take-profit-percent">Default Take Profit %:</label>
            <input
              type="number"
              id="take-profit-percent"
              name="take-profit-percent"
            />
            <label for="stop-loss-percent">Default Stop Loss %:</label>
            <input
              type="number"
              id="stop-loss-percent"
              name="stop-loss-percent"
            />
            <label for="notification-cooldown"
              >Notification Cooldown (Min):</label
            >
            <input
              type="number"
              id="notification-cooldown"
              name="notification-cooldown"
            />
          </form>
        </div>

        <div id="appearance-settings-panel" class="settings-panel">
          <h3>Appearance</h3>
          <form id="appearance-settings-form">
            <label for="theme-selector">Theme:</label>
            <select id="theme-selector" name="theme-selector"></select>
            <label for="font-selector">Font:</label>
            <select id="font-selector" name="font-selector"></select>
          </form>
        </div>

        <div id="data-management-settings-panel" class="settings-panel">
          <h3>Data Management</h3>
          <div class="settings-sub-tabs">
            <button
              class="settings-sub-tab active"
              data-sub-tab="sources-panel"
            >
              Advice Sources
            </button>
            <button class="settings-sub-tab" data-sub-tab="exchanges-panel">
              Exchanges
            </button>
            <button class="settings-sub-tab" data-sub-tab="webapps-panel">
              Web Apps
            </button>
          </div>

          <div id="sources-panel" class="sub-panel active">
            <h4>Add New Advice Source</h4>
            <form id="add-new-source-form">
              <select id="new-source-type" name="type">
                <option value="" selected disabled>Select a type...</option>
                <option value="person">Person</option>
                <option value="group">Group</option>
                <option value="book">Book</option>
                <option value="website">Website</option>
              </select>
              <div id="new-source-fields-container" style="display: none">
                <div id="new-source-name-wrapper">
                  <label for="new-source-name">Name:</label>
                  <input
                    type="text"
                    id="new-source-name"
                    name="name"
                    required
                  />
                </div>
                <div id="new-source-url-wrapper" style="display: none">
                  <label for="new-source-url">URL:</label>
                  <input type="url" id="new-source-url" name="url" />
                </div>
                <div id="new-source-description-wrapper">
                  <label for="new-source-description">Description:</label>
                  <textarea
                    id="new-source-description"
                    name="description"
                  ></textarea>
                </div>
                <div id="new-source-image-path-wrapper">
                  <label for="new-source-image-path">Image Path:</label>
                  <input
                    type="text"
                    id="new-source-image-path"
                    name="image_path"
                  />
                </div>
                <div
                  id="new-source-panel-person"
                  class="source-type-panel"
                  style="display: none"
                >
                  <h5>Person Details</h5>
                  <label for="new-source-contact-email">Email:</label>
                  <input
                    type="email"
                    id="new-source-contact-email"
                    name="person_email"
                  />
                  <label for="new-source-contact-phone">Phone:</label>
                  <input
                    type="tel"
                    id="new-source-contact-phone"
                    name="person_phone"
                  />
                  <label for="new-source-contact-app-type">Contact App:</label>
                  <input
                    type="text"
                    id="new-source-contact-app-type"
                    name="person_app_type"
                  />
                  <label for="new-source-contact-app-handle">App Handle:</label>
                  <input
                    type="text"
                    id="new-source-contact-app-handle"
                    name="person_app_handle"
                  />
                </div>
                <div
                  id="new-source-panel-group"
                  class="source-type-panel"
                  style="display: none"
                >
                  <h5>Group Details</h5>
                  <label for="new-source-group-person">Primary Contact:</label>
                  <input
                    type="text"
                    id="new-source-group-person"
                    name="group_primary_contact"
                  />
                  <label for="new-source-group-email">Contact Email:</label>
                  <input
                    type="email"
                    id="new-source-group-email"
                    name="group_email"
                  />
                  <label for="new-source-group-phone">Group Phone:</label>
                  <input
                    type="tel"
                    id="new-source-group-phone"
                    name="group_phone"
                  />
                  <label for="new-source-group-app-type">Group App:</label>
                  <input
                    type="text"
                    id="new-source-group-app-type"
                    name="group_app_type"
                  />
                  <label for="new-source-group-app-handle"
                    >Group App Handle:</label
                  >
                  <input
                    type="text"
                    id="new-source-group-app-handle"
                    name="group_app_handle"
                  />
                </div>
                <div
                  id="new-source-panel-book"
                  class="source-type-panel"
                  style="display: none"
                >
                  <h5>Book Details</h5>
                  <div id="new-source-book-author-wrapper">
                    <label for="new-source-book-author">Author:</label>
                    <input
                      type="text"
                      id="new-source-book-author"
                      name="book_author"
                    />
                  </div>
                  <div id="new-source-book-isbn-wrapper">
                    <label for="new-source-book-isbn">ISBN:</label>
                    <input
                      type="text"
                      id="new-source-book-isbn"
                      name="book_isbn"
                    />
                  </div>
                  <div id="new-source-book-websites-wrapper">
                    <label for="new-source-book-websites">Book URL:</label>
                    <input
                      type="text"
                      id="new-source-book-websites"
                      name="book_websites"
                    />
                  </div>
                  <div id="new-source-book-pdfs-wrapper">
                    <label for="new-source-book-pdfs"
                      >PDFs (comma-separated):</label
                    >
                    <input
                      type="text"
                      id="new-source-book-pdfs"
                      name="book_pdfs"
                    />
                  </div>
                  <div id="new-source-book-strategies-table">
                    <h5>Strategies</h5>
                    <p>Strategies table will be loaded here.</p>
                  </div>
                </div>
                <div
                  id="new-source-panel-website"
                  class="source-type-panel"
                  style="display: none"
                >
                  <h5>Website Details</h5>
                  <div id="new-source-website-websites-wrapper">
                    <label for="new-source-website-websites"
                      >Relevant Links (comma-separated):</label
                    >
                    <input
                      type="text"
                      id="new-source-website-websites"
                      name="website_websites"
                    />
                  </div>
                  <div id="new-source-website-pdfs-wrapper">
                    <label for="new-source-website-pdfs"
                      >Saved Docs (comma-separated):</label
                    >
                    <input
                      type="text"
                      id="new-source-website-pdfs"
                      name="website_pdfs"
                    />
                  </div>
                  <div id="new-source-website-strategies-table">
                    <h5>Strategies</h5>
                    <p>Strategies table will be loaded here.</p>
                  </div>
                </div>
                <div class="form-actions">
                  <button type="submit">Add Source</button>
                  <button
                    type="button"
                    id="clear-new-source-btn"
                    class="clear-btn"
                  >
                    Clear
                  </button>
                </div>
              </div>
            </form>
            <hr />
            <h4>Advice Sources</h4>
            <div id="advice-source-list"></div>
          </div>

          <div id="exchanges-panel" class="sub-panel">
            <h4>Add New Exchange</h4>
            <form id="add-exchange-form">
              <label for="new-exchange-name">Name:</label>
              <input
                type="text"
                id="new-exchange-name"
                name="new-exchange-name"
                required
              />
              <div class="form-actions">
                <button type="submit" id="add-exchange-btn">
                  Add Exchange
                </button>
                <button type="button" id="clear-exchange-btn" class="clear-btn">
                  Clear
                </button>
              </div>
            </form>
            <hr />
            <h4>Exchanges</h4>
            <div id="exchange-list"></div>
          </div>

          <div id="webapps-panel" class="sub-panel">
            <h4>Add New Web App</h4>
            <form id="add-webapp-form">
              <label for="new-webapp-name">Name:</label>
              <input
                type="text"
                id="new-webapp-name"
                name="new-webapp-name"
                required
              />
              <div class="form-actions">
                <button type="submit" id="add-webapp-btn">Add Web App</button>
                <button type="button" id="clear-webapp-btn" class="clear-btn">
                  Clear
                </button>
              </div>
            </form>
            <hr />
            <h4>Web Apps</h4>
            <div id="webapp-list"></div>
          </div>
        </div>

        <div id="user-management-settings-panel" class="settings-panel">
          <h3>User Management</h3>
          <div class="settings-sub-tabs">
            <button class="settings-sub-tab active" data-sub-tab="users-panel">
              Users
            </button>
            <button class="settings-sub-tab" data-sub-tab="subscriptions-panel">
              Subscriptions
            </button>
          </div>

          <div id="users-panel" class="sub-panel active">
            <h4>Add New Account Holder</h4>
            <form id="add-holder-form">
              <label for="new-holder-name">Name:</label>
              <input
                type="text"
                id="new-holder-name"
                name="new-holder-name"
                required
              />
              <div class="form-actions">
                <button type="submit" id="add-account-holder-btn">
                  Add Holder
                </button>
                <button type="button" id="clear-holder-btn" class="clear-btn">
                  Clear
                </button>
              </div>
            </form>
            <hr />
            <h4>Account Holders</h4>
            <div id="account-holder-list"></div>
          </div>

          <div id="subscriptions-panel" class="sub-panel">
            <h4 id="subscriptions-panel-title">Manage Subscriptions</h4>
            <div id="subscriptions-panel-list-container"></div>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" id="save-settings-button">
            Save All Settings
          </button>
        </div>
      </div>
    </div>

    <div id="edit-source-modal" class="modal" style="display: none">
      <div class="modal-content">
        <span class="close-button">&times;</span>
        <h2>Edit Advice Source</h2>
        <form id="edit-source-form">
          <input type="hidden" id="edit-source-id" />
          <label for="edit-source-type">Type:</label>
          <select id="edit-source-type" name="type">
            <option value="" selected disabled>Select a type...</option>
            <option value="person">Person</option>
            <option value="group">Group</option>
            <option value="book">Book</option>
            <option value="website">Website</option>
          </select>

          <div id="edit-source-fields-container" style="display: none">
            <div id="edit-source-name-wrapper">
              <label for="edit-source-name">Name:</label>
              <input type="text" id="edit-source-name" name="name" required />
            </div>
            <div id="edit-source-url-wrapper" style="display: none">
              <label for="edit-source-url">URL:</label>
              <input type="url" id="edit-source-url" name="url" />
            </div>
            <div id="edit-source-description-wrapper">
              <label for="edit-source-description">Description:</label>
              <textarea
                id="edit-source-description"
                name="description"
              ></textarea>
            </div>
            <div id="edit-source-image-path-wrapper">
              <label for="edit-source-image-path">Image Path:</label>
              <input
                type="text"
                id="edit-source-image-path"
                name="image_path"
              />
            </div>

            <div
              id="edit-source-panel-person"
              class="source-type-panel"
              style="display: none"
            >
              <h5>Person Details</h5>
              <label for="edit-source-contact-email">Email:</label>
              <input
                type="email"
                id="edit-source-contact-email"
                name="person_email"
              />
              <label for="edit-source-contact-phone">Phone:</label>
              <input
                type="tel"
                id="edit-source-contact-phone"
                name="person_phone"
              />
              <label for="edit-source-contact-app-type">Contact App:</label>
              <input
                type="text"
                id="edit-source-contact-app-type"
                name="person_app_type"
              />
              <label for="edit-source-contact-app-handle">App Handle:</label>
              <input
                type="text"
                id="edit-source-contact-app-handle"
                name="person_app_handle"
              />
            </div>
            <div
              id="edit-source-panel-group"
              class="source-type-panel"
              style="display: none"
            >
              <h5>Group Details</h5>
              <label for="edit-source-group-person">Primary Contact:</label>
              <input
                type="text"
                id="edit-source-group-person"
                name="group_primary_contact"
              />
              <label for="edit-source-group-email">Contact Email:</label>
              <input
                type="email"
                id="edit-source-group-email"
                name="group_email"
              />
              <label for="edit-source-group-phone">Group Phone:</label>
              <input
                type="tel"
                id="edit-source-group-phone"
                name="group_phone"
              />
              <label for="edit-source-group-app-type">Group App:</label>
              <input
                type="text"
                id="edit-source-group-app-type"
                name="group_app_type"
              />
              <label for="edit-source-group-app-handle"
                >Group App Handle:</label
              >
              <input
                type="text"
                id="edit-source-group-app-handle"
                name="group_app_handle"
              />
            </div>
            <div
              id="edit-source-panel-book"
              class="source-type-panel"
              style="display: none"
            >
              <h5>Book Details</h5>
              <div id="edit-source-book-author-wrapper">
                <label for="edit-source-book-author">Author:</label>
                <input
                  type="text"
                  id="edit-source-book-author"
                  name="book_author"
                />
              </div>
              <div id="edit-source-book-isbn-wrapper">
                <label for="edit-source-book-isbn">ISBN:</label>
                <input type="text" id="edit-source-book-isbn" name="book_isbn" />
              </div>
              <div id="edit-source-book-websites-wrapper">
                <label for="edit-source-book-websites">Book URL:</label>
                <input
                  type="text"
                  id="edit-source-book-websites"
                  name="book_websites"
                />
              </div>
              <div id="edit-source-book-pdfs-wrapper">
                <label for="edit-source-book-pdfs">PDFs (comma-separated):</label>
                <input type="text" id="edit-source-book-pdfs" name="book_pdfs" />
              </div>
              <div id="edit-source-book-strategies-table">
                <h5>Strategies</h5>
                <p>Strategies table will be loaded here.</p>
              </div>
            </div>
            <div
              id="edit-source-panel-website"
              class="source-type-panel"
              style="display: none"
            >
              <h5>Website Details</h5>
              <div id="edit-source-website-websites-wrapper">
                <label for="edit-source-website-websites"
                  >Relevant Links (comma-separated):</label
                >
                <input
                  type="text"
                  id="edit-source-website-websites"
                  name="website_websites"
                />
              </div>
              <div id="edit-source-website-pdfs-wrapper">
                <label for="edit-source-website-pdfs"
                  >Saved Docs (comma-separated):</label
                >
                <input type="text" id="edit-source-website-pdfs" name="website_pdfs" />
              </div>
              <div id="edit-source-website-strategies-table">
                <h5>Strategies</h5>
                <p>Strategies table will be loaded here.</p>
              </div>
            </div>
            <div class="modal-footer">
              <button type="submit">Save Changes</button>
              <button
                type="button"
                id="clear-edit-source-button"
                class="clear-btn"
              >
                Clear
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
    <script src="./js/app-main.js" type="module"></script>
        <div id="source-detail-modal" class="modal">
          <div class="modal-content">
            <span class="close-button">&times;</span>
            <div class="source-detail-modal-header-body">
              <div class="source-detail-left-panel">
                <div id="source-profile-container">
                  <!-- Source profile details will be rendered here -->
                </div>
                <div id="source-feature-btn-container">
                  <!-- Add Strategy or Add Idea button will be rendered here -->
                  <button id="edit-strategy-btn" class="btn">Edit Strategy</button>
                </div>
              </div>
              <div class="source-detail-right-panel">
                <!-- Strategy/Trade Idea forms and tables will be rendered here -->
              </div>
            </div>
            <div class="source-detail-bottom-panel">
              <div id="idea-table-placeholder">
                <h4>Ideas</h4>
                <p>Table for ideas will go here.</p>
              </div>
              <div id="open-trades-table-placeholder">
                <h4>Open Trades</h4>
                <p>Table for open trades will go here.</p>
              </div>
              <div id="paper-trades-table-placeholder">
                <h4>Paper Trades</h4>
                <p>Table for paper trades will go here.</p>
              </div>
                    </div>
                  </div>
                </div>
            
                <!-- Add Strategy Form Modal -->
                <div id="add-strategy-modal" class="modal">
                  <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h4>Log New Strategy</h4>
                    <form id="log-strategy-form">
                      <input type="hidden" id="strategy-source-id" name="source_id">
                      <label for="strategy-title">Strategy Title:</label>
                      <input type="text" id="strategy-title" name="title" required>
                      <label for="strategy-chapter">Chapter:</label>
                      <input type="text" id="strategy-chapter" name="chapter">
                      <label for="strategy-page">Page Number:</label>
                      <input type="number" id="strategy-page" name="page_number">
                      
                      <label for="strategy-description">Description:</label>
                      <textarea id="strategy-description" name="description"></textarea>
                      <label for="strategy-pdf-path">PDF File Path:</label>
                      <input type="text" id="strategy-pdf-path" name="pdf_path" placeholder="pdf_repo/my_strategy.pdf">
                      
                      <div class="form-actions">
                        <button type="submit" class="btn">Save Strategy</button>
                        <button type="button" id="cancel-strategy-form-btn" class="clear-btn btn">Cancel</button>
                      </div>
                    </form>
                  </div>
                </div>
              </body></html>
